
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Football Draft Wheel</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #f0f0f0;
      padding: 20px;
    }
    canvas {
      background: #fff;
      border-radius: 50%;
      margin-top: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 20px;
      cursor: pointer;
    }
    #result {
      font-size: 1.5em;
      margin-top: 20px;
      color: #333;
    }
  </style>
</head>
<body>
  <h1>Football Draft Wheel</h1>
  <canvas id="wheel" width="500" height="500"></canvas>
  <br />
  <button onclick="spin()">üé° Spin</button>
  <button onclick="resetWheel()">üîÅ Reset</button>
  <div id="result"></div>

  <script src="categories_full.js" defer></script>
  <script defer>
    let categories = [];
    fetch('categories_full.js')
      .then(res => res.text())
      .then(code => {
        eval(code);
        initializeWheel();
      });

    let canvas, ctx, currentAngle = 0, spinning = false, usedIndices = new Set();

    function initializeWheel() {
      canvas = document.getElementById('wheel');
      ctx = canvas.getContext('2d');
      drawWheel();
    }

    function drawWheel() {
      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;
      const radius = 200;
      const total = categories.length;
      const angle = (2 * Math.PI) / total;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      for (let i = 0; i < total; i++) {
        ctx.beginPath();
        ctx.moveTo(centerX, centerY);
        ctx.fillStyle = `hsl(${(i * 360) / total}, 70%, 60%)`;
        ctx.arc(centerX, centerY, radius, i * angle + currentAngle, (i + 1) * angle + currentAngle);
        ctx.lineTo(centerX, centerY);
        ctx.fill();

        ctx.save();
        ctx.translate(centerX, centerY);
        ctx.rotate(i * angle + angle / 2 + currentAngle);
        ctx.textAlign = "right";
        ctx.fillStyle = "#000";
        ctx.font = "12px Arial";
        ctx.fillText(categories[i].slice(0, 20), radius - 10, 5); // trim long text
        ctx.restore();
      }

      // Pointer
      ctx.beginPath();
      ctx.moveTo(centerX, centerY - radius - 20);
      ctx.lineTo(centerX - 10, centerY - radius - 5);
      ctx.lineTo(centerX + 10, centerY - radius - 5);
      ctx.fillStyle = "#f00";
      ctx.fill();
    }

    function getRandomIndex() {
      let index;
      do {
        index = Math.floor(Math.random() * categories.length);
      } while (usedIndices.has(index));
      return index;
    }

    function spin() {
      if (spinning || usedIndices.size === categories.length) return;

      spinning = true;
      const randomIndex = getRandomIndex();
      const anglePerSegment = (2 * Math.PI) / categories.length;
      const stopAngle = (2 * Math.PI) * 5 + (categories.length - randomIndex) * anglePerSegment;

      let start = null;
      function animate(timestamp) {
        if (!start) start = timestamp;
        const progress = timestamp - start;
        const ease = 1 - Math.pow(1 - Math.min(progress / 3000, 1), 3);
        currentAngle = ease * stopAngle;
        drawWheel();

        if (progress < 3000) {
          requestAnimationFrame(animate);
        } else {
          spinning = false;
          usedIndices.add(randomIndex);
          document.getElementById('result').innerText = `üéØ ${categories[randomIndex]}`;
        }
      }
      requestAnimationFrame(animate);
    }

    function resetWheel() {
      usedIndices.clear();
      currentAngle = 0;
      drawWheel();
      document.getElementById('result').innerText = '';
    }
  </script>
</body>
</html>
